# Install Chocolatey (a package manager for Windows)
Set-ExecutionPolicy Bypass -Scope Process -Force; iex ((New-Object System.Net.WebClient).DownloadString('https://chocolatey.org/install.ps1'))

# Add Chocolatey Binaries Directory to PATH
$chocolateyBinPath = 'C:\ProgramData\chocolatey\bin'
[Environment]::SetEnvironmentVariable("Path", "$env:Path;$chocolateyBinPath", [EnvironmentVariableTarget]::Machine)

# Install Python using Chocolatey
choco install python3 -y

# Add Python and Scripts directories to the PATH
$pythonPath = Get-Command python | ForEach-Object { $_.Source }
$pythonScriptsPath = Join-Path $pythonPath "Scripts"
[Environment]::SetEnvironmentVariable("Path", "$env:Path;$pythonPath;$pythonScriptsPath", [EnvironmentVariableTarget]::Machine)

# Refresh the environment variables
$env:Path = [System.Environment]::GetEnvironmentVariable("Path", [System.EnvironmentVariableTarget]::Machine)

# Install Flask using pip
pip install Flask

# Check if Python and Flask are installed
if (python --version -like '*Python*') {
    echo "Python is installed successfully."
} else {
    echo "Failed to install Python."
}

if (pip show Flask) {
    echo "Flask is installed successfully."
} else {
    echo "Failed to install Flask."
}
